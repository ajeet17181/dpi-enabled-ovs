<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>DPI enabled OVS by kspviswa</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>DPI enabled OVS</h1>
        <p>Extending Open vSwitch with Deep Packet Inspection functionalities</p>

        <p class="view"><a href="https://github.com/kspviswa/dpi-enabled-ovs">View the Project on GitHub <small>kspviswa/dpi-enabled-ovs</small></a></p>


        <ul>
          <li><a href="https://github.com/kspviswa/dpi-enabled-ovs/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/kspviswa/dpi-enabled-ovs/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/kspviswa/dpi-enabled-ovs">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h3>
<a id="what-is-this-project-about-" class="anchor" href="#what-is-this-project-about-" aria-hidden="true"><span class="octicon octicon-link"></span></a>What is this project about ?</h3>

<p>This a fork of <a href="https://github.com/openvswitch/ovs">Open vSwitch</a>, with <b>additional interface to load 3rd party / external / customer DPI engine </b> on top of Open vSwitch.
This project is part of my MS Thesis (BITS). </p>

<h3>
<a id="why-dpi--ovs-" class="anchor" href="#why-dpi--ovs-" aria-hidden="true"><span class="octicon octicon-link"></span></a>Why DPI + OVS ?</h3>

<p>By definition, DPI – Deep Packet Inspection means, determining the application (Ex Youtube, Skype etc) by analyzing the Ethernet frames. Advantage of DPI is that, enterprise level decisions can be made based upon the analyzed data.  (Ex. Boost the bandwidth, Determine the application level network usage etc.)</p>

<p>It is important to understand that, DPI is not, merely a packet analysis, but it also provides capabilities for network steering upon the data it receives from the network. Though the traffic analysis can be made centralized in the controller plane, the effective classification of packet can be done, only at the switch level.</p>

<p>If you look at the present scenario in traditional networking ecosystem, DPI is performed by highly specialized hardware with proprietary DPI techniques. This makes sense, as long as the network is made of traditional hardware oriented set ups. Industry had started to embrace the SDN ecosystem, where-in, any commodity hardware can be used to virtualize network functions (NFV). Hence DPI in specialized hardware doesn’t make sense anymore. DPI has to be even virtualized.</p>

<h3>
<a id="dpi-in-ovs" class="anchor" href="#dpi-in-ovs" aria-hidden="true"><span class="octicon octicon-link"></span></a>DPI in OVS</h3>

<p>Presently there is no DPI enabled soft switch, especially in the SDN ecosystem. The aim of this project ( part of my MS Thesis in BITS) is to provide DPI functionalities as part of Open vSwitch, so that any controller can take advantage of the DPI information and leverage the DPI functionalities to upper management layers. </p>

<h3>
<a id="high-level-design" class="anchor" href="#high-level-design" aria-hidden="true"><span class="octicon octicon-link"></span></a>High level design</h3>

<p>The following fig, gives high-level overview on how DPI engine can be integrated.</p>

<p><img src="https://cloud.githubusercontent.com/assets/7476271/7811632/9a58fd88-03c9-11e5-8d1a-a6b539179193.png" alt="High-level-design"></p>

<ul>
<li>
<code>packet_clone for DPI</code> is very much necessary to create a new packet, as not all packets, reach <code>ovs upcall handler</code> due to flow cache that is maintained in kernel.</li>
<li>
<code>Opaque DPI Interface</code> clearly abstracts Open vSwitch to outside world. So dynamically, any 3rd party / external / customer DPI engine can be hooked with OVS seamlessly.</li>
</ul>

<h3>
<a id="packet-flow-with-new-dpi-plugin" class="anchor" href="#packet-flow-with-new-dpi-plugin" aria-hidden="true"><span class="octicon octicon-link"></span></a>Packet flow with new DPI plugin</h3>

<p><img src="https://cloud.githubusercontent.com/assets/7476271/7811649/ad68b116-03c9-11e5-8285-389982720a58.png" alt="packet flow"> </p>

<p>As you can see, for every incoming packet (green), corresponding DPI packets (black) will be cloned. As per existing logic, some packets (blue) will reach userspace for special processing, however all DPI packets (black) will reach DPI handler in userspace. This is very much necessary for any DPI engine. More packets == More data to analyse == Better results.</p>

<h3>
<a id="project-highlights" class="anchor" href="#project-highlights" aria-hidden="true"><span class="octicon octicon-link"></span></a>Project highlights</h3>

<ul>
<li>A new interface <code>dpi_plugin.h</code> which integrates OVS with any 3rd party / custom / DPI plugin.</li>
<li>Kernel datapath modified to clone all the incoming packets to send it to userspace with special label fpr DPI</li>
<li>A new <code>DpiWriteLog()</code> function, which enables plugin developers to log their contents directly into OVS logging framework. A handly tool for debugging &amp; maintenance.</li>
<li>A sample DPI plugin <code>kspviswa-nDPI-plugin</code> that will demonstrate the power of <code>dpi-enabled-ovs</code>
</li>
<li>* This plugin comes with its corresponding web-based application to view the DPI info at business application level.</li>
</ul>

<h3>
<a id="sample-dpi-plugin" class="anchor" href="#sample-dpi-plugin" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sample DPI plugin</h3>

<p>Inorder to demonstrate the power of DPI enabled OVS, I wrote a sample plugin, that will collect the DPI data directly via OVS, powered by <a href="https://github.com/ntop/nDPI">nDPI engine</a>. Then with help of <a href="https://developers.google.com/chart/">Google charts</a> API, I wrote a sample visualization application (analogous to business application on controller side) to harness the DPI information.</p>

<h2>
<a id="mode-of-deployment" class="anchor" href="#mode-of-deployment" aria-hidden="true"><span class="octicon octicon-link"></span></a>Mode of deployment</h2>

<p>I had introduced a command-line switch to dynamically load any DPI plugin. Here is the syntax</p>

<p><code>sudo ovs-vswitchd --dpi-engine=&lt;path to plugin&gt;</code></p>

<h2>
<a id="high-level-design-1" class="anchor" href="#high-level-design-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>High level design</h2>

<p>Here is the high level design of the plugin</p>

<p><img src="https://cloud.githubusercontent.com/assets/7476271/7811671/d4c92f88-03c9-11e5-9118-ff0ca5c334df.png" alt="dpi plugin"></p>

<h2>
<a id="demo-output" class="anchor" href="#demo-output" aria-hidden="true"><span class="octicon octicon-link"></span></a>Demo Output</h2>

<p>Here is the output from the business application. </p>

<p><img src="https://cloud.githubusercontent.com/assets/7476271/7811689/ee441c98-03c9-11e5-8fbd-181bfb49e6eb.png" alt="dpi visio"></p>

<h3>
<a id="further-development--contact" class="anchor" href="#further-development--contact" aria-hidden="true"><span class="octicon octicon-link"></span></a>Further development &amp; contact</h3>

<p>This project is part of my MS thesis. Feel free to contact me if you wish to take this project to next step, want to know how to deploy / enhance etc.</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/kspviswa">kspviswa</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>
